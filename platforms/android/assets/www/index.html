<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <!--<meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *">-->
        <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval' ">

        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <link rel="stylesheet" type="text/css" href="css/reset.css">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <link rel="stylesheet" type="text/css" href="css/meteo.css">
        <title>Potager connecté</title>
    </head>
    <body>
      <header>

            <div class="hamburger">
                <span></span>
            </div> 
            <nav>
                <ul>
                    <li class="title">Menu</li>
                    <li><a href="#">Paramètres</a></li>
                    <li><a href="pagelegume.html">Fiches techniques</a></li>
                    <li><a href="#">Mes potagers</a></li>
                    <li><a href="meteo.html">Météo</a></li>
                    <li><a href="#">Déconnexion</a></li>
                </ul>
            </nav>
        </header>

        <div id="meteo">
            <p>
                <span class="strong">Mon-Potager-1</span> <span class="temp special">? </span>°C <span class="humidite special">? </span>% Hum.
                <span id="button"><img src="img/arrows.svg" alt=""></span>
            </p>
        </div>

        <script type="text/javascript" src="js/libs/jquery.js"></script>

        <script> 

            $('.hamburger').click(function() {
                $('.hamburger').toggleClass('active');
                $('nav').toggleClass('active');
            });

            var urlville = "";

            $( document ).ready(function() {  

                $.ajax({
                    url: 'json/weather.json',
                    dataType: 'json',
                    success: function( reponse ) {
                                    urlville = reponse.city.ville; 
                                },

                    error: function( req, status, err ) {
                        console.log( 'something went wrong', status, err );
                    } 
                });

            });

            $("#button img").click(function() {
                $.ajax({
                    url: 'http://api.openweathermap.org/data/2.5/forecast/weather?q=' + urlville + '&APPID=e69b1050a4287b8f2591f7545a2c0a07',
                    dataType: 'json',
                    success: function( reponse ) {
                                    $('.temp').html( Math.round(reponse.list[0].main.temp - 273.15) ); 
                                    $('.humidite').html( reponse.list[0].main.humidity ); 
                                },

                    error: function( req, status, err ) {
                        console.log( 'something went wrong', status, err );
                    } 
                })
            });
        </script>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
    </body>
</html>
